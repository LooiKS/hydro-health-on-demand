(window["webpackJsonphydro-health-on-demand"]=window["webpackJsonphydro-health-on-demand"]||[]).push([[0],{157:function(e,t,a){e.exports=a.p+"static/media/favicon.942e51a6.png"},185:function(e,t,a){e.exports=a(381)},190:function(e,t,a){},191:function(e,t,a){},380:function(e,t,a){},381:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),s=a(37),o=a.n(s),i=(a(190),a(191),a(42)),l=a(25),c=a(13),m=a(14),u=a(16),d=a(15),p=a(17),h=a(27),g=Object(h.c)({accessToken:"pk.eyJ1IjoibG9vaWtpYW5zZW5nIiwiYSI6ImNqdWF3MzFrMzA2bmYzeXBkMGdkMTdsM2sifQ.SMkjjzrxv1Gwmf127YmGpA"}),v=(r.Component,function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentWillMount",value:function(){console.log(this.props.num)}},{key:"render",value:function(){return n.a.createElement("div",{className:"param_"+(this.props.num<4?"upper":"lower")+"_column"},n.a.createElement("div",{className:"horseshoe_upper_wrapper"},n.a.createElement("div",{className:"horseshoe"},n.a.createElement("div",{className:"radial-wrapper"},n.a.createElement("h1",{className:"param_value unit_value"+this.props.num,id:"text1"},this.props.value),n.a.createElement("h1",{className:"param_unit unit_value"+this.props.num},this.props.unit),n.a.createElement("div",{className:"radial-section radial-right-section"},n.a.createElement("div",{className:"wedge"+this.props.num})),n.a.createElement("div",{className:"radial-section radial-left-section"},n.a.createElement("div",{className:"wedge"+this.props.num})),n.a.createElement("div",{className:"marker"+this.props.num+" start"}),n.a.createElement("div",{className:"marker"+this.props.num+" end"})),n.a.createElement("div",{className:"radial-wrapper radial-progress-wrapper"},n.a.createElement("div",{className:"radial-section radial-right-section"},n.a.createElement("div",{className:"wedge"+this.props.num,id:"right1",style:{WebkitTransform:"rotateZ("+this.props.right_degree+"deg)",transform:"rotateZ("+this.props.right_degree+"deg)"}})),n.a.createElement("div",{className:"radial-section radial-left-section"},n.a.createElement("div",{className:"wedge"+this.props.num,id:"left1",style:{WebkitTransform:"rotateZ("+this.props.left_degree+"deg)",transform:"rotateZ("+this.props.left_degree+"deg)"}})),n.a.createElement("div",{className:"marker"+this.props.num+" start"}),n.a.createElement("div",{className:"marker"+this.props.num+" end",id:"marker1",style:{WebkitTransform:"rotateZ("+this.props.marker_degree+"deg)",transform:"rotateZ("+this.props.marker_degree+"deg)"}}))),n.a.createElement("h1",{className:"param_title"},this.props.param)))}}]),t}(r.Component)),y=a(28),f=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=[];return this.props.dataSelected.forEach((function(t){e.push(n.a.createElement(y.c,{key:t,type:"monotone",dataKey:t,stroke:"#8884d8"}))})),n.a.createElement(y.d,{width:1500,height:500,data:this.props.data},n.a.createElement(y.f,{dataKey:"time_s",interval:0,padding:{left:20,right:100}}),n.a.createElement(y.g,{allowDataOverflow:!0},n.a.createElement(y.a,{value:"any"})),n.a.createElement(y.e,null),n.a.createElement(y.b,null),e)}}]),t}(r.Component),b=!1,E=function(e){function t(){var e,a;Object(c.a)(this,t);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(n)))).state={param:["Conductivity","Dissolved Oxygen","Total Dissolved Solids","Turbidity","pH","Temperature"],dataSelected:"tds",unit:["\u03bcS","mg/L","mg/L","NTU","","\u2103"],isLoading:!0,response:[{turbidity:"10.0",tds:"26.7",stateName_s:"<none>",conductivity:"0.0",temperature:"29.6",ph:"7.4",timestamp_s:"1568132527788",time_s:"2019-09-11T00:22:07.788",oxygen:"8.8",mac_s:"3426465185477481",wqi:"48.3"},{turbidity:"2895.9",tds:"32.7",stateName_s:"<none>",conductivity:"0.0",temperature:"29.8",ph:"7.9",timestamp_s:"1568132001675",time_s:"2019-09-11T00:13:21.675",oxygen:"9.1",mac_s:"3426465185477481",wqi:"33.1"},{turbidity:"3.8",tds:"2.1",stateName_s:"<none>",conductivity:"0.0",temperature:"27.3",ph:"9.1",timestamp_s:"1558700348374",time_s:"2019-05-24T20:19:08.374",oxygen:"7.3",mac_s:"3426465185477481",wqi:"45.0"},{turbidity:"3.8",tds:"98.0",stateName_s:"<none>",conductivity:"0.0",temperature:"27.6",ph:"9.3",timestamp_s:"1558700278550",time_s:"2019-05-24T20:17:58.550",oxygen:"3.5",mac_s:"3426465185477481",wqi:"31.4"},{turbidity:"3.8",tds:"0.0",stateName_s:"<none>",conductivity:"0.0",temperature:"28.9",ph:"9.3",timestamp_s:"1558693401451",time_s:"2019-05-24T18:23:21.451",oxygen:"7.1",mac_s:"3426465185477481",wqi:"43.8"},{turbidity:"3.8",tds:"0.0",stateName_s:"<none>",conductivity:"0.0",temperature:"28.8",ph:"9.3",timestamp_s:"1558693334911",time_s:"2019-05-24T18:22:14.911",oxygen:"7.0",mac_s:"3426465185477481",wqi:"43.7"},{turbidity:"3.8",tds:"0.0",stateName_s:"<none>",conductivity:"0.0",temperature:"28.9",ph:"9.3",timestamp_s:"1558693268038",time_s:"2019-05-24T18:21:08.038",oxygen:"7.1",mac_s:"3426465185477481",wqi:"43.8"}],values:{conductivity:{marker:0,left:0,right:0,oldValue:50},oxygen:{marker:0,left:0,right:0,oldValue:50},tds:{marker:0,left:0,right:0,oldValue:50},turbidity:{marker:0,left:0,right:0,oldValue:50},ph:{marker:0,left:0,right:0,oldValue:50},temperature:{marker:0,left:0,right:0,oldValue:50}}},a.abortController=new AbortController,a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;this.get_xpand(),b=!0,this.lookupInterval=setInterval((function(){console.log("out"),b||(b=!0,e.get_xpand(),console.log("in"))}),5e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.lookupInterval),this.abortController.abort()}},{key:"render",value:function(){return this.state.isLoading?n.a.createElement("div",null,"Loading Data"):n.a.createElement("div",{style:{backgroundColor:"black"}},n.a.createElement("div",{className:"monitor_status_bar"},n.a.createElement("h2",{className:"page-header"},"Monitor Parameter Value"),n.a.createElement("div",{className:"upper_status_bar"},n.a.createElement(v,{num:"1",param:this.state.param[0],unit:this.state.unit[0],value:this.state.response[this.state.response.length-1].conductivity,marker_degree:this.state.values.conductivity.marker,left_degree:this.state.values.conductivity.left,right_degree:this.state.values.conductivity.right,onClick:function(e){console.log(e)}}),n.a.createElement(v,{num:"2",param:this.state.param[1],unit:this.state.unit[1],value:this.state.response[this.state.response.length-1].oxygen,marker_degree:this.state.values.oxygen.marker,left_degree:this.state.values.oxygen.left,right_degree:this.state.values.oxygen.right}),n.a.createElement(v,{num:"3",param:this.state.param[2],unit:this.state.unit[2],value:this.state.response[this.state.response.length-1].tds,marker_degree:this.state.values.tds.marker,left_degree:this.state.values.tds.left,right_degree:this.state.values.tds.right})),n.a.createElement("div",{className:"lower_status_bar"},n.a.createElement(v,{num:"4",param:this.state.param[3],unit:this.state.unit[3],value:this.state.response[this.state.response.length-1].turbidity,marker_degree:this.state.values.turbidity.marker,left_degree:this.state.values.turbidity.left,right_degree:this.state.values.turbidity.right}),n.a.createElement(v,{num:"5",param:this.state.param[4],unit:this.state.unit[4],value:this.state.response[this.state.response.length-1].ph,marker_degree:this.state.values.ph.marker,left_degree:this.state.values.ph.left,right_degree:this.state.values.ph.right}),n.a.createElement(v,{num:"6",param:this.state.param[5],unit:this.state.unit[5],value:this.state.response[this.state.response.length-1].temperature,marker_degree:this.state.values.temperature.marker,left_degree:this.state.values.temperature.left,right_degree:this.state.values.temperature.right}))),n.a.createElement("div",null,n.a.createElement(f,{data:this.state.response,dataSelected:["oxygen","tds","turbidity","ph","temperature","conductivity"]}),n.a.createElement(f,{data:this.state.response,dataSelected:["conductivity"]}),n.a.createElement(f,{data:this.state.response,dataSelected:["oxygen"]}),n.a.createElement(f,{data:this.state.response,dataSelected:["tds"]}),n.a.createElement(f,{data:this.state.response,dataSelected:["turbidity"]}),n.a.createElement(f,{data:this.state.response,dataSelected:["ph"]}),n.a.createElement(f,{data:this.state.response,dataSelected:["temperature"]})))}},{key:"changeProgressDial",value:function(e,t){if(t<=66){e.right=-181,e.oldValue>66&&(e.right=-181,e.marker=0);var a=-Math.abs(180-Math.round(2.7*t));e.left=a+1,e.marker=a}else{e.oldValue<=66&&(e.left=0,e.marker=0);var r=-90-2.7*(100-t);e.right=r,e.marker=180+r}return e.oldValue=t,e}},{key:"get_xpand",value:function(e,t){var a=this;fetch("https://cors-anywhere.herokuapp.com/https://iot.xpand.asia/developer/api/applicationmgt/authenticate",{headers:{"X-Secret":"UmNvalVjX09Td2JtY0NHTE9ST3AyNFdpbUdrYTpyTXRQaVNOVzNsTEhHaEREWDZSbFRmYjM0bVVh","Content-Type":"application/json"},signal:this.abortController.signal}).then((function(e){return e.json()})).then((function(r){a.xpandGetJWT(r.access_token,e,t)}))}},{key:"xpandGetJWT",value:function(e,t,a,r){var n=this;fetch("https://cors-anywhere.herokuapp.com/https://iot.xpand.asia/developer/api/usermgt/v1/authenticate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify({username:"utmgroup02@noreply.com",password:"teamh2o"}),signal:this.abortController.signal}).then((function(e){return e.json()})).then((function(a){n.xpandGetData(a["X-IoT-JWT"],e,t,r)}))}},{key:"xpandGetData",value:function(e,t,a,r){var n=this;fetch("https://cors-anywhere.herokuapp.com/https://iot.xpand.asia/developer/api/datamgt/v1/user/devicehistory?eventName=Try&deviceIds=16492&noOfEvents=7&zoneId=Asia%2FKuala_Lumpur",{headers:{Authorization:"Bearer "+t,"X-IoT-JWT":e},signal:this.abortController.signal}).then((function(e){return console.log(e),e.json()})).then((function(e){console.log("this value",JSON.stringify(e[16492]));var t=n.state.values;console.log("temp",t),t.conductivity=n.changeProgressDial(n.state.values.conductivity,e[16492][0].conductivity/6e3*100),t.oxygen=n.changeProgressDial(n.state.values.oxygen,e[16492][0].oxygen/8.8*100),t.tds=n.changeProgressDial(n.state.values.tds,e[16492][0].tds/3500*100),t.turbidity=n.changeProgressDial(n.state.values.turbidity,e[16492][0].turbidity/50*100),t.ph=n.changeProgressDial(n.state.values.ph,(e[16492][0].ph-5)/9*100),t.temperature=n.changeProgressDial(n.state.values.temperature,(e[16492][0].temperature-16)/24*100),n.setState({values:t,response:e[16492].reverse(),isLoading:!1}),b=!1}))}}]),t}(r.Component),k=a(19),_=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){for(var e="",t=0;t<4;t++)e+=this.props.borderColor.split(",")[0]+","+this.props.borderColor.split(",")[1]+","+25*(t+1)+"%) ";return console.log(e),n.a.createElement("div",{style:{borderColor:e,borderWidth:"15px",borderStyle:"solid",color:this.props.textColor,margin:"1vh 2.5vw"}},n.a.createElement("h4",null,this.props.text),n.a.createElement("h4",null,this.props.count))}}]),t}(r.Component),x=Object(h.c)({accessToken:"pk.eyJ1IjoibG9vaWtpYW5zZW5nIiwiYSI6ImNqdWF3MzFrMzA2bmYzeXBkMGdkMTdsM2sifQ.SMkjjzrxv1Gwmf127YmGpA"}),j=[103.6715,1.5177],w=[7],S=function(){var e=Object(l.e)(),t=Object(r.useState)({location:[{lat:1.5177,lon:103.6715,name:"JB Sutera Mall",type:"scattermapbox",mode:"markers",state:"Safe",response:[]},{lat:3.172788,lon:101.719556,name:"5G Ericsson KL",type:"scattermapbox",mode:"markers",state:"",response:[]},{lat:1.555145,lon:103.63764,name:"UTM JB Lake",type:"scattermapbox",mode:"markers",state:"Safe"},{lat:1.460468,lon:103.940487,name:"Sungai Kim Kim",type:"scattermapbox",mode:"markers",state:"Safe"},{lat:3.828111,lon:103.265507,name:"Sungai Tiram",type:"scattermapbox",mode:"markers",state:"Safe"},{lat:2.892086,lon:101.68903,name:"Sungai Langat",type:"scattermapbox",mode:"markers",state:"Safe"},{lat:3.496129,lon:102.912493,name:"Sungai Pahang",type:"scattermapbox",mode:"markers",state:"Extremely Polluted"},{lat:2.235268,lon:102.256568,name:"Sungai Malacca",type:"scattermapbox",mode:"markers",state:"Polluted"},{lat:4.370342,lon:101.072384,name:"Sungai Kinta",type:"scattermapbox",mode:"markers",state:"Polluted"}]}),a=Object(k.a)(t,2),s=a[0],o=a[1],i=Object(r.useState)(!1),c=Object(k.a)(i,2),m=c[0],u=c[1],d=Object(r.useState)(""),p=Object(k.a)(d,2),g=(p[0],p[1],Object(r.useState)([])),v=Object(k.a)(g,2),y=(v[0],v[1]),f=Object(r.useState)(!0),b=Object(k.a)(f,2),E=b[0],S=b[1],O=Object(r.useState)(0),N=Object(k.a)(O,2),T=N[0],C=N[1],M=Object(r.useState)(0),W=Object(k.a)(M,2),I=W[0],L=W[1],A=Object(r.useState)(0),z=Object(k.a)(A,2),P=z[0],V=z[1],D=Object(r.useState)(!0),J=Object(k.a)(D,2),Y=J[0],G=J[1],F=new AbortController,X=F.signal;function q(e,t){fetch("https://cors-anywhere.herokuapp.com/https://iot.xpand.asia/developer/api/applicationmgt/authenticate",{headers:{"X-Secret":"UmNvalVjX09Td2JtY0NHTE9ST3AyNFdpbUdrYTpyTXRQaVNOVzNsTEhHaEREWDZSbFRmYjM0bVVh","Content-Type":"application/json"},signal:X}).then((function(e){return e.json()})).then((function(e){var t;t=e.access_token,fetch("https://cors-anywhere.herokuapp.com/https://iot.xpand.asia/developer/api/usermgt/v1/authenticate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify({username:"utmgroup02@noreply.com",password:"teamh2o"}),signal:X}).then((function(e){return e.json()})).then((function(e){!function(e,t,a,r){fetch("https://cors-anywhere.herokuapp.com/https://iot.xpand.asia/developer/api/datamgt/v1/user/devicehistory?eventName=Try&deviceIds=16492&noOfEvents=7&zoneId=Asia%2FKuala_Lumpur",{headers:{Authorization:"Bearer "+t,"X-IoT-JWT":e},signal:X}).then((function(e){return console.log(e),e.json()})).then((function(e){console.log("result: ",e[16492][0]),y(e[16492]),S(!1);var t=s;t.location.forEach((function(t){"5G Ericsson KL"===t.name&&(t.state=e[16492][0].wqi>=40?"Safe":e[16492][0].wqi>=30?"Polluted":"Extremely Polluted")})),o(t);var a=0,r=0,n=0;s.location.forEach((function(e){console.log(e.name,e.state),"Safe"===e.state?a++:"Polluted"===e.state?r++:n++})),C(a),L(r),V(n),G(!1)}))}(e["X-IoT-JWT"],t)}))}))}var B="";Object(r.useEffect)((function(){return console.log(typeof s),q(),G(!0),B=setInterval((function(){console.log("out11"),Y||(G(!0),q(),console.log("in111"))}),5e3),function(){F.abort(),clearInterval(B)}}),[]);var U={width:"33.33%"},Z={fontFamily:"Comic Sans MS",fontSize:"1em",textAlign:"left",paddingLeft:"1.5em"};return E?n.a.createElement("div",null,"Loading Data..."):n.a.createElement("div",null,n.a.createElement("h3",{style:Z},"Number of river spot according to the pollution level"),n.a.createElement("div",{style:{display:"flex"}},n.a.createElement("div",{style:U},n.a.createElement(_,{textColor:"green",borderColor:"hsl(120,100%,50%)",text:"SAFE",count:T})),n.a.createElement("div",{style:U},n.a.createElement(_,{textColor:"yellow",borderColor:"hsl(60,100%,50%)",text:"POLLUTED",count:I})),n.a.createElement("div",{style:U},n.a.createElement(_,{textColor:"red",borderColor:"hsl(0,100%,50%)",text:"EXTREMELY POLLUTED",count:P}))),n.a.createElement("h3",{style:Z},"Location of devices in Malaysia"),n.a.createElement("div",{style:{border:"5px orange solid",display:"-webkit-inline-box"}},n.a.createElement(x,{zoom:w,style:"mapbox://styles/mapbox/streets-v9",containerStyle:{height:"65vh",width:"95vw",display:"table-cell"},center:j,onClick:function(e,t){return console.log("onClickMap!",t.lngLat)}},m?n.a.createElement(h.b,{coordinates:[m.lon,m.lat],offset:{"bottom-left":[12,0],bottom:[0,-10],"bottom-right":[-12,-38]}},n.a.createElement("div",{dangerouslySetInnerHTML:{__html:m.description}})):n.a.createElement("div",null),function(){var t=[],a="";return s.location.forEach((function(r){console.log(r.state),a="Safe"===r.state?"green":"Polluted"===r.state?"yellow":"red",console.log(a),t.push(n.a.createElement(h.a,{key:r.name,properties:{description:"<strong>"+r.name+"</strong>"},coordinates:[r.lon,r.lat],anchor:"bottom",onClick:function(t){console.log("mouse click",t),e.push("/monitor")},onMouseEnter:function(e){console.log("mouse enter",e),u({lat:r.lat,lon:r.lon,description:"<strong>"+r.name+"</strong>"})},onMouseLeave:function(e){console.log("mouse leave",e),u(!1)}},n.a.createElement("div",{style:{zIndex:1e3,width:"1em",height:"1em",backgroundColor:a,borderRadius:"50%"}})))})),console.log(t),t}())))},O=a(157),N=a.n(O);var T=function(){return n.a.createElement("div",{className:"App"},n.a.createElement(i.a,null,n.a.createElement("div",{className:"",style:{backgroundColor:"blue",justifyContent:"flexStart !important",position:"relative",display:"flex",flexWrap:"wrap",alignItems:"center",padding:".5rem 1rem"}},n.a.createElement("div",{style:{width:"60%",color:"white",textAlign:"left",paddingLeft:"5em"}},n.a.createElement("img",{src:N.a,style:{width:"2em"},alt:"Water logo"}),n.a.createElement("span",null,"Hydro Health On-demand")),n.a.createElement("div",{style:{width:"40%"}},n.a.createElement(i.b,{className:"btn btn-success mx-2",to:"/"},"Home"),n.a.createElement(i.b,{className:"btn btn-success mx-2",to:"monitor"},"Monitor"))),n.a.createElement(l.a,{exact:!0,path:"/",component:S}),n.a.createElement(l.a,{path:"/monitor",component:E})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(379),a(380);o.a.render(n.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[185,1,2]]]);
//# sourceMappingURL=main.48922ea3.chunk.js.map